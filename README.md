# HybridRoute-Optimizer-API

ğŸ“œ è®¸å¯è¯
æœ¬é¡¹ç›®é‡‡ç”¨ GNU General Public License v3.0 (GPL-3.0) è®¸å¯è¯ã€‚

ä½ å¯ä»¥ï¼š
âœ… è‡ªç”±ä½¿ç”¨ã€å­¦ä¹ å’Œè¿è¡Œæœ¬è½¯ä»¶
âœ… è‡ªç”±ä¿®æ”¹å’Œæ‰©å±•åŠŸèƒ½
âœ… è‡ªç”±åˆ†å‘åŸç‰ˆæˆ–ä¿®æ”¹ç‰ˆ
ä½ å¿…é¡»ï¼š
ğŸ“ æ˜ç¡®æ ‡æ³¨åŸå§‹ä½œè€…ï¼ˆç½²åï¼‰
ğŸ”“ ä¿æŒå¼€æºï¼šä»»ä½•è¡ç”Ÿä½œå“å¿…é¡»ä½¿ç”¨ç›¸åŒè®¸å¯è¯
ğŸ›¡ï¸ ä¸å¾—ç”³è¯·ä¸“åˆ©ï¼šä¸å¾—å°±æœ¬è½¯ä»¶æˆ–è¡ç”Ÿä½œå“ç”³è¯·ä¸“åˆ©
å®Œæ•´è®¸å¯è¯æ–‡æœ¬ï¼š
è¯¦è§ LICENSE æ–‡ä»¶æˆ–è®¿é—® GNUå®˜æ–¹ç½‘ç«™

âš ï¸ é‡è¦æç¤º
ä»»ä½•åŸºäºæœ¬é¡¹ç›®çš„è¡ç”Ÿä½œå“éƒ½å¿…é¡»ï¼š

æ˜ç¡®æ ‡æ³¨åŸå§‹é¡¹ç›®åœ°å€å’Œä½œè€…
ä½¿ç”¨ç›¸åŒçš„GPL-3.0è®¸å¯è¯å¼€æº
ä¸å¾—å°±ç›¸å…³æŠ€æœ¯ç”³è¯·ä¸“åˆ©æˆ–è¿›è¡Œä¸“åˆ©è¯‰è®¼
è¿åè®¸å¯è¯æ¡æ¬¾å°†é¢ä¸´æ³•å¾‹è´£ä»»

## é¡¹ç›®ç®€ä»‹

è¿™æ˜¯ä¸€ä¸ªå®Œå…¨ä½¿ç”¨Pythonå®ç°çš„è·¯å¾„è§„åˆ’å™¨ï¼ŒåŸºäºæ¨¡æ‹Ÿé€€ç«ç®—æ³•å’Œ2-optå±€éƒ¨æœç´¢ä¼˜åŒ–ã€‚è¯¥é¡¹ç›®æ˜¯å¯¹åŸå§‹C++è·¯å¾„è§„åˆ’ä»£ç çš„å®Œæ•´é‡å†™ï¼Œè§£å†³äº†C++ç¼–è¯‘ä¸ºPythonæ¨¡å—æ—¶å¯èƒ½é‡åˆ°çš„DLLåŠ è½½é—®é¢˜ã€‚

## åŠŸèƒ½ç‰¹ç‚¹

- **çº¯Pythonå®ç°**ï¼šæ— éœ€ç¼–è¯‘ï¼Œç›´æ¥è¿è¡Œ
- **å¤šç§ç®—æ³•æ”¯æŒ**ï¼š
  - æ¨¡æ‹Ÿé€€ç«ç®—æ³•ï¼ˆé€‚ç”¨äºå¤§è§„æ¨¡é—®é¢˜ï¼‰
  - ç²¾ç¡®è§£è®¡ç®—ï¼ˆé€‚ç”¨äºå°è§„æ¨¡é—®é¢˜ï¼Œn â‰¤ 12ï¼‰
  - 2-optå±€éƒ¨æœç´¢ä¼˜åŒ–
- **çµæ´»çš„é…ç½®å‚æ•°**ï¼šå¯è‡ªå®šä¹‰å†·å´ç‡ã€åˆå§‹æ¸©åº¦ã€æœ€å¤§è¿­ä»£æ¬¡æ•°ç­‰
- **å¤šèµ·ç‚¹å¤šç»ˆç‚¹é€‰æ‹©**ï¼šè‡ªåŠ¨é€‰æ‹©æœ€ä¼˜çš„èµ·ç‚¹å’Œç»ˆç‚¹ç»„åˆ
- **è·ç¦»ç¼“å­˜**ï¼šå¯é€‰çš„è·ç¦»è®¡ç®—ç¼“å­˜åŠŸèƒ½ï¼Œæé«˜æ€§èƒ½

## å¿«é€Ÿå¼€å§‹

### ç›´æ¥ä½¿ç”¨

1. ç¡®ä¿æ‚¨çš„ç³»ç»Ÿå·²å®‰è£…Python 3.6æˆ–æ›´é«˜ç‰ˆæœ¬

2. è¿è¡Œæµ‹è¯•è„šæœ¬æŸ¥çœ‹æ•ˆæœï¼š
   ```bash
   python test_route_planner_python.py
   ```

### åœ¨æ‚¨çš„ä»£ç ä¸­ä½¿ç”¨

```python
from route_planner_python import Coordinate, AlgorithmConfig, RoutePlanner, print_result

# åˆ›å»ºé…ç½®
config = AlgorithmConfig()
config.cooling_rate = 0.995
config.initial_temperature = 10000.0
config.max_iterations = 100000

# åˆ›å»ºè·¯å¾„è§„åˆ’å™¨
planner = RoutePlanner(config)

# å®šä¹‰èµ·ç‚¹ã€é€”ç»ç‚¹å’Œç»ˆç‚¹
starts = [Coordinate(116.397428, 39.90923)]  # åŒ—äº¬å¤©å®‰é—¨
waypoints = [
    Coordinate(116.466263, 39.921466),  # é¢å’Œå›­
    Coordinate(116.432919, 39.999659)   # å¥¥æ—åŒ¹å…‹å…¬å›­
]
ends = [Coordinate(116.473168, 39.993015)]  # åŒ—äº¬å—ç«™

# æ‰§è¡Œè·¯å¾„è§„åˆ’
result = planner.plan_route(starts, waypoints, ends)

# æ‰“å°ç»“æœ
print_result(result)

# é‡Šæ”¾ç¼“å­˜ï¼ˆå¤§è§„æ¨¡è®¡ç®—åï¼‰
planner.clear_distance_cache()
```

## ç±»å’Œæ–¹æ³•è¯´æ˜

### Coordinate ç±»
è¡¨ç¤ºåœ°ç†åæ ‡ç‚¹
- `__init__(longitude=0.0, latitude=0.0)`: åˆå§‹åŒ–åæ ‡
- å±æ€§: `longitude`ï¼ˆç»åº¦ï¼‰, `latitude`ï¼ˆçº¬åº¦ï¼‰

### AlgorithmConfig ç±»
ç®—æ³•é…ç½®å‚æ•°
- `__init__(cooling_rate=0.995, initial_temperature=10000.0, max_iterations=100000)`: åˆå§‹åŒ–é…ç½®
- å±æ€§: 
  - `cooling_rate`: æ¨¡æ‹Ÿé€€ç«å†·å´ç‡
  - `initial_temperature`: åˆå§‹æ¸©åº¦
  - `max_iterations`: æœ€å¤§è¿­ä»£æ¬¡æ•°
  - `use_cache`: æ˜¯å¦å¯ç”¨è·ç¦»ç¼“å­˜ï¼ˆé»˜è®¤ä¸ºTrueï¼‰
  - `enable_local_search`: æ˜¯å¦å¯ç”¨2-optå±€éƒ¨æœç´¢ï¼ˆé»˜è®¤ä¸ºTrueï¼‰

### RoutePlanner ç±»
è·¯å¾„è§„åˆ’çš„ä¸»è¦ç±»
- `__init__(config=None)`: åˆå§‹åŒ–è·¯å¾„è§„åˆ’å™¨
- `plan_route(starts, waypoints, ends)`: è§„åˆ’è·¯å¾„
  - å‚æ•°: `starts`ï¼ˆèµ·ç‚¹åˆ—è¡¨ï¼‰, `waypoints`ï¼ˆé€”ç»ç‚¹åˆ—è¡¨ï¼‰, `ends`ï¼ˆç»ˆç‚¹åˆ—è¡¨ï¼‰
  - è¿”å›: `RouteResult`å¯¹è±¡
- `clear_distance_cache()`: æ¸…ç†è·ç¦»ç¼“å­˜

### RouteResult ç±»
è·¯å¾„è§„åˆ’ç»“æœ
- å±æ€§: 
  - `path`: è§„åˆ’çš„è·¯å¾„ï¼ˆåæ ‡ç‚¹åˆ—è¡¨ï¼‰
  - `total_distance`: æ€»è·ç¦»ï¼ˆç±³ï¼‰
  - `execution_time_ms`: è®¡ç®—è€—æ—¶ï¼ˆæ¯«ç§’ï¼‰
  - `start_index`: æœ€ä½³èµ·ç‚¹ç´¢å¼•
  - `end_index`: æœ€ä½³ç»ˆç‚¹ç´¢å¼•

## è¾…åŠ©å‡½æ•°

- `generate_random_coordinates(count, lon_min, lon_max, lat_min, lat_max)`: ç”Ÿæˆéšæœºåæ ‡
- `print_coordinates(coords, title)`: æ‰“å°åæ ‡åˆ—è¡¨
- `print_result(result)`: æ‰“å°è·¯å¾„è§„åˆ’ç»“æœ

## æ€§èƒ½è¯´æ˜

- å¯¹äºå°è§„æ¨¡é—®é¢˜ï¼ˆé€”ç»ç‚¹æ•°é‡ â‰¤ 12ï¼‰ï¼Œä½¿ç”¨ç²¾ç¡®ç®—æ³•æ±‚è§£
- å¯¹äºå¤§è§„æ¨¡é—®é¢˜ï¼ˆé€”ç»ç‚¹æ•°é‡ > 12ï¼‰ï¼Œä½¿ç”¨æ¨¡æ‹Ÿé€€ç«ç®—æ³•å’Œ2-optä¼˜åŒ–
- ä½¿ç”¨è·ç¦»ç¼“å­˜å¯æ˜¾è‘—æé«˜é‡å¤è®¡ç®—çš„æ€§èƒ½
- è®¡ç®—æ—¶é—´ä¸é—®é¢˜è§„æ¨¡ã€ç®—æ³•å‚æ•°è®¾ç½®æœ‰å…³

## é—®é¢˜è§£å†³æ–¹æ¡ˆ

åŸå§‹C++ä»£ç åœ¨ç¼–è¯‘ä¸ºPythonæ¨¡å—æ—¶å¯èƒ½é‡åˆ°DLLåŠ è½½å¤±è´¥é—®é¢˜ã€‚æœ¬é¡¹ç›®é€šè¿‡ä»¥ä¸‹æ–¹å¼è§£å†³ï¼š

1. **å®Œå…¨Pythoné‡å†™**ï¼šå°†C++ä»£ç çš„æ‰€æœ‰åŠŸèƒ½ç›´æ¥ç”¨Pythonå®ç°
2. **ä¿ç•™åŸæœ‰ç®—æ³•é€»è¾‘**ï¼šç¡®ä¿è®¡ç®—ç»“æœä¸åŸå§‹å®ç°ä¸€è‡´
3. **ç§»é™¤ç¼–è¯‘ä¾èµ–**ï¼šæ— éœ€å®‰è£…MinGWã€MSVCç­‰ç¼–è¯‘å™¨
4. **ç®€åŒ–ä½¿ç”¨æµç¨‹**ï¼šæ— éœ€å¤æ‚çš„ç¯å¢ƒé…ç½®

## APIæœåŠ¡ä½¿ç”¨è¯´æ˜

æœ¬é¡¹ç›®æä¾›äº†åŸºäºFastAPIçš„RESTful APIæœåŠ¡ï¼Œå¯ä»¥ä½œä¸ºè·¯å¾„è§„åˆ’æ¥å£ä½¿ç”¨ã€‚

### å¯åŠ¨APIæœåŠ¡

```bash
python main.py
```

æœåŠ¡å°†åœ¨ http://0.0.0.0:8000 å¯åŠ¨

### APIç«¯ç‚¹

#### POST /plan_route

ç”¨äºè§„åˆ’è·¯å¾„çš„ä¸»è¦ç«¯ç‚¹ã€‚

### è¯·æ±‚å‚æ•°

```json
{
  "optimization_target": "string",  // ä¼˜åŒ–ç›®æ ‡ï¼šdriving_time, driving_distance, straight_distance
  "amap_key": "string",             // å¯é€‰ï¼Œä½¿ç”¨é«˜å¾·åœ°å›¾APIæ—¶éœ€è¦
  "origin": [float, float],          // èµ·ç‚¹åæ ‡ [ç»åº¦, çº¬åº¦]
  "destination": [float, float],     // ç»ˆç‚¹åæ ‡ [ç»åº¦, çº¬åº¦]
  "waypoints": [                     // å¯é€‰ï¼Œé€”ç»ç‚¹åˆ—è¡¨
    [float, float],
    ...
  ],
  "cooling_rate": float,             // å¯é€‰ï¼Œæ¨¡æ‹Ÿé€€ç«å†·å´ç‡ï¼Œé»˜è®¤ä¸º0.995
  "initial_temperature": float,      // å¯é€‰ï¼Œåˆå§‹æ¸©åº¦ï¼Œé»˜è®¤ä¸º10000.0
  "max_iterations": int,             // å¯é€‰ï¼Œæœ€å¤§è¿­ä»£æ¬¡æ•°ï¼Œé»˜è®¤ä¸º100000
  "use_cache": boolean,              // å¯é€‰ï¼Œæ˜¯å¦ä½¿ç”¨ç¼“å­˜ï¼Œé»˜è®¤ä¸ºTrue
  "enable_local_search": boolean     // å¯é€‰ï¼Œæ˜¯å¦å¯ç”¨å±€éƒ¨æœç´¢ï¼Œé»˜è®¤ä¸ºTrue
}
```

### å“åº”æ ¼å¼

```json
{
  "optimization_target": "string",  // ä¼˜åŒ–ç›®æ ‡
  "total_distance": float,           // æ€»è·ç¦»ï¼ˆç±³ï¼‰
  "total_time": float,               // é©¾è½¦æ¨¡å¼ä¸‹çš„æ€»æ—¶é—´ï¼ˆç§’ï¼‰
  "path": [                          // è§„åˆ’çš„è·¯å¾„ç‚¹åˆ—è¡¨
    [float, float],
    ...
  ],
  "execution_time_ms": float,        // è®¡ç®—è€—æ—¶ï¼ˆæ¯«ç§’ï¼‰
  "start_point": [float, float],     // èµ·ç‚¹åæ ‡
  "end_point": [float, float],       // ç»ˆç‚¹åæ ‡
  "waypoints_order": [int, ...]      // é€”ç»ç‚¹çš„è®¿é—®é¡ºåºï¼ˆç´¢å¼•ï¼‰
}
```

### è¯·æ±‚ç¤ºä¾‹

#### ä½¿ç”¨ç›´çº¿è·ç¦»è§„åˆ’

```bash
curl -X POST "http://localhost:8000/plan_route" \
  -H "Content-Type: application/json" \
  -d '{
    "optimization_target": "straight_distance",
    "origin": [116.397428, 39.90923],
    "destination": [116.473168, 39.993015],
    "waypoints": [
      [116.466263, 39.921466],
      [116.432919, 39.999659]
    ]
  }'
```

#### ä½¿ç”¨é©¾è½¦è·¯çº¿è§„åˆ’ï¼ˆéœ€è¦é«˜å¾·åœ°å›¾APIå¯†é’¥ï¼‰

```bash
curl -X POST "http://localhost:8000/plan_route" \
  -H "Content-Type: application/json" \
  -d '{
    "optimization_target": "driving_distance",
    "amap_key": "your_amap_api_key",
    "origin": [116.397428, 39.90923],
    "destination": [116.473168, 39.993015]
  }'
```

## æµ‹è¯•ç”¨ä¾‹

é¡¹ç›®åŒ…å«ä¸¤ä¸ªæµ‹è¯•è„šæœ¬ï¼š
- `route_planner_python.py`: åŒ…å«å®Œæ•´çš„è·¯å¾„è§„åˆ’å™¨å®ç°å’Œç®€å•çš„æµ‹è¯•åŠŸèƒ½
- `test_route_planner_python.py`: æä¾›æ›´è¯¦ç»†çš„æµ‹è¯•ç”¨ä¾‹ï¼ŒåŒ…æ‹¬ç®€å•å’Œå¤æ‚è·¯å¾„è§„åˆ’

## æ³¨æ„äº‹é¡¹

- è·¯å¾„è§„åˆ’åŸºäºåœ°çƒè¡¨é¢è·ç¦»è®¡ç®—ï¼ˆHaversineå…¬å¼ï¼‰
- å¯¹äºå¤§è§„æ¨¡é—®é¢˜ï¼Œå¯è°ƒæ•´ç®—æ³•å‚æ•°ä»¥å¹³è¡¡è®¡ç®—é€Ÿåº¦å’Œç»“æœè´¨é‡
- å¤§è§„æ¨¡è®¡ç®—åï¼Œå»ºè®®è°ƒç”¨`clear_distance_cache()`é‡Šæ”¾å†…å­˜
- Pythonç‰ˆæœ¬çš„æ€§èƒ½å¯èƒ½ç•¥ä½äºC++ç‰ˆæœ¬ï¼Œä½†ä½¿ç”¨æ›´åŠ ä¾¿æ·

## ç‰ˆæœ¬å†å²

- v1.0: åˆå§‹ç‰ˆæœ¬ï¼Œå®ŒæˆåŸºæœ¬åŠŸèƒ½å®ç°

## ä½œè€…ä¿¡æ¯

æ­¤é¡¹ç›®ç”±AIåŠ©æ‰‹æ ¹æ®åŸå§‹C++ä»£ç é‡å†™ä¸ºPythonç‰ˆæœ¬ã€‚
